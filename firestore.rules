rules_version = '2';
service cloud.firestore {
  match /databases/{database}/documents {

    // 얼리버드 신청 컬렉션
    match /earlybird_applications/{document} {
      // 누구나 신청 가능 (create)
      allow create: if true;

      // 최근 신청자 목록 조회를 위한 읽기 권한 (공개)
      // 주의: JavaScript에서 개인정보(name, email, phone 등)는 표시하지 않음
      allow read: if true;

      // 업데이트: 비밀번호 인증 시스템 사용 중이므로 허용
      // 주의: 실제 운영 시에는 더 엄격한 규칙 권장
      allow update: if true;

      // 삭제: 비밀번호 인증 시스템 사용 중이므로 허용
      // 주의: 실제 운영 시에는 더 엄격한 규칙 권장
      allow delete: if true;
    }

    // 방문자 추적 컬렉션
    match /page_visitors/{document} {
      // 누구나 방문 기록 생성 가능
      allow create: if true;

      // 읽기는 공개 (비밀번호 인증 시스템 사용)
      allow read: if true;

      // 업데이트와 삭제는 불가
      allow update, delete: if false;
    }

    // 교보문고 순위 정보 컬렉션
    match /kyobobook_rank/{document} {
      // 읽기는 공개 (관리자 페이지에서 표시)
      allow read: if true;

      // 쓰기는 비밀번호 인증 시스템 사용 중이므로 허용
      // 주의: 실제 운영 시에는 더 엄격한 규칙 권장
      allow create, update: if true;
      allow delete: if false;
    }

    // 교보문고 순위 히스토리 컬렉션
    match /kyobobook_rank_history/{document} {
      // 읽기는 공개 (관리자 페이지에서 표시)
      allow read: if true;

      // 쓰기는 비밀번호 인증 시스템 사용 중이므로 허용
      // 주의: 실제 운영 시에는 더 엄격한 규칙 권장
      allow create, update, delete: if true;
    }

    // 설정 컬렉션 (이메일 자동발송 등)
    match /settings/{document} {
      // 읽기/쓰기 모두 허용 (비밀번호 인증 시스템 사용)
      // 주의: 실제 운영 시에는 더 엄격한 규칙 권장
      allow read, write: if true;
    }
  }
}
